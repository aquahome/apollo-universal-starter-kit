From 9c136463dbf9ccd9abe4620b21dc1d5d0c28eb98 Mon Sep 17 00:00:00 2001
From: Aleksey Zadorozhniy <zadorozhniyal@gmail.com>
Date: Fri, 16 Mar 2018 12:13:08 +0200
Subject: [PATCH 1/4] Move PageLayout from components to router

---
 .../src/modules/contact/components/ContactView.web.jsx     |  5 ++---
 .../src/modules/counter/components/CounterView.web.jsx     | 10 +++++-----
 packages/client/src/modules/defaultRouter/index.web.jsx    |  8 ++++++--
 .../src/modules/pageNotFound/containers/PageNotFound.jsx   |  6 +++---
 .../src/modules/post/components/PostEditView.web.jsx       |  9 ++++-----
 .../client/src/modules/post/components/PostList.web.jsx    | 10 +++++-----
 .../subscription/components/SubscribersOnlyView.jsx        |  5 ++---
 .../subscription/components/SubscriptionView.web.jsx       |  5 ++---
 .../modules/subscription/components/UpdateCardView.web.jsx |  5 ++---
 .../src/modules/upload/components/UploadView.web.jsx       |  6 +++---
 .../src/modules/user/components/ForgotPasswordView.web.jsx |  5 ++---
 .../client/src/modules/user/components/LoginView.web.jsx   |  6 +++---
 .../client/src/modules/user/components/ProfileView.web.jsx | 14 +++++++-------
 .../src/modules/user/components/RegisterView.web.jsx       |  5 ++---
 .../src/modules/user/components/ResetPasswordView.web.jsx  |  5 ++---
 .../client/src/modules/user/components/UserEditView.jsx    |  9 ++++-----
 packages/client/src/modules/user/components/Users.web.jsx  |  6 +++---
 packages/client/src/testHelpers/Renderer.js                |  5 ++++-
 18 files changed, 61 insertions(+), 63 deletions(-)

diff --git a/packages/client/src/modules/contact/components/ContactView.web.jsx b/packages/client/src/modules/contact/components/ContactView.web.jsx
index b7bd3756..80c0ef05 100644
--- a/packages/client/src/modules/contact/components/ContactView.web.jsx
+++ b/packages/client/src/modules/contact/components/ContactView.web.jsx
@@ -2,7 +2,6 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { LayoutCenter } from '../../common/components';
-import { PageLayout } from '../../common/components/web';
 
 import ContactForm from './ContactForm';
 import settings from '../../../../../../settings';
@@ -46,13 +45,13 @@ export default class ContactView extends React.Component {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Contact Us</h1>
           <ContactForm onSubmit={this.onSubmit({ contact })} sent={this.state.sent} />
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/counter/components/CounterView.web.jsx b/packages/client/src/modules/counter/components/CounterView.web.jsx
index 22c0599f..3e5bd925 100644
--- a/packages/client/src/modules/counter/components/CounterView.web.jsx
+++ b/packages/client/src/modules/counter/components/CounterView.web.jsx
@@ -2,7 +2,7 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import styled from 'styled-components';
-import { PageLayout, Button } from '../../common/components/web';
+import { Button } from '../../common/components/web';
 import settings from '../../../../../../settings';
 
 const Section = styled.section`
@@ -25,14 +25,14 @@ const CounterView = ({ loading, counter, addCounter, reduxCount, onReduxIncremen
 
   if (loading) {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <div className="text-center">Loading...</div>
-      </PageLayout>
+      </section>
     );
   } else {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <Section>
           <p>
@@ -57,7 +57,7 @@ const CounterView = ({ loading, counter, addCounter, reduxCount, onReduxIncremen
             Click to increase apolloLinkState
           </Button>
         </Section>
-      </PageLayout>
+      </section>
     );
   }
 };
diff --git a/packages/client/src/modules/defaultRouter/index.web.jsx b/packages/client/src/modules/defaultRouter/index.web.jsx
index ff2f2379..cec7d1bf 100644
--- a/packages/client/src/modules/defaultRouter/index.web.jsx
+++ b/packages/client/src/modules/defaultRouter/index.web.jsx
@@ -2,10 +2,14 @@ import React from 'react';
 import { Switch } from 'react-router-dom';
 
 import modules from '../';
-
+import { PageLayout } from '../common/components/web';
 import Feature from '../connector';
 
-const routerFactory = () => <Switch>{modules.routes}</Switch>;
+const routerFactory = () => (
+  <PageLayout>
+    <Switch>{modules.routes}</Switch>
+  </PageLayout>
+);
 
 export default new Feature({
   routerFactory
diff --git a/packages/client/src/modules/pageNotFound/containers/PageNotFound.jsx b/packages/client/src/modules/pageNotFound/containers/PageNotFound.jsx
index aac34433..60c2c149 100644
--- a/packages/client/src/modules/pageNotFound/containers/PageNotFound.jsx
+++ b/packages/client/src/modules/pageNotFound/containers/PageNotFound.jsx
@@ -3,7 +3,7 @@ import PropTypes from 'prop-types';
 import { Link } from 'react-router-dom';
 import Helmet from 'react-helmet';
 import styled from 'styled-components';
-import { PageLayout, Button } from '../../common/components/web';
+import { Button } from '../../common/components/web';
 import settings from '../../../../../../settings';
 
 const Section = styled.section`
@@ -13,7 +13,7 @@ const Section = styled.section`
 const PageNotFound = ({ staticContext = {} }) => {
   staticContext.pageNotFound = true;
   return (
-    <PageLayout>
+    <section>
       <Section>
         <Helmet
           title={`${settings.app.name} - Page not found`}
@@ -31,7 +31,7 @@ const PageNotFound = ({ staticContext = {} }) => {
           </Button>
         </Link>
       </Section>
-    </PageLayout>
+    </section>
   );
 };
 
diff --git a/packages/client/src/modules/post/components/PostEditView.web.jsx b/packages/client/src/modules/post/components/PostEditView.web.jsx
index cfed131e..7dd2c69e 100644
--- a/packages/client/src/modules/post/components/PostEditView.web.jsx
+++ b/packages/client/src/modules/post/components/PostEditView.web.jsx
@@ -3,7 +3,6 @@ import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { Link } from 'react-router-dom';
 
-import { PageLayout } from '../../common/components/web';
 import PostForm from './PostForm';
 import PostComments from '../containers/PostComments';
 import settings from '../../../../../../settings';
@@ -37,14 +36,14 @@ const PostEditView = ({ loading, post, match, location, subscribeToMore, addPost
 
   if (loading && !postObj) {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <div className="text-center">Loading...</div>
-      </PageLayout>
+      </section>
     );
   } else {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <Link id="back-button" to="/posts">
           Back
@@ -59,7 +58,7 @@ const PostEditView = ({ loading, post, match, location, subscribeToMore, addPost
             subscribeToMore={subscribeToMore}
           />
         )}
-      </PageLayout>
+      </section>
     );
   }
 };
diff --git a/packages/client/src/modules/post/components/PostList.web.jsx b/packages/client/src/modules/post/components/PostList.web.jsx
index c2c9167a..ec24c26b 100644
--- a/packages/client/src/modules/post/components/PostList.web.jsx
+++ b/packages/client/src/modules/post/components/PostList.web.jsx
@@ -2,7 +2,7 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { Link } from 'react-router-dom';
-import { PageLayout, Table, Button } from '../../common/components/web';
+import { Table, Button } from '../../common/components/web';
 import settings from '../../../../../../settings';
 
 export default class PostList extends React.PureComponent {
@@ -44,10 +44,10 @@ export default class PostList extends React.PureComponent {
     const { loading, posts, loadMoreRows } = this.props;
     if (loading) {
       return (
-        <PageLayout>
+        <section>
           {this.renderMetaData()}
           <div className="text-center">Loading...</div>
-        </PageLayout>
+        </section>
       );
     } else {
       const columns = [
@@ -78,7 +78,7 @@ export default class PostList extends React.PureComponent {
         }
       ];
       return (
-        <PageLayout>
+        <section>
           {this.renderMetaData()}
           <h2>Posts</h2>
           <Link to="/post/0">
@@ -92,7 +92,7 @@ export default class PostList extends React.PureComponent {
             </small>
           </div>
           {this.renderLoadMore(posts, loadMoreRows)}
-        </PageLayout>
+        </section>
       );
     }
   }
diff --git a/packages/client/src/modules/subscription/components/SubscribersOnlyView.jsx b/packages/client/src/modules/subscription/components/SubscribersOnlyView.jsx
index daa76c60..959f7b0e 100644
--- a/packages/client/src/modules/subscription/components/SubscribersOnlyView.jsx
+++ b/packages/client/src/modules/subscription/components/SubscribersOnlyView.jsx
@@ -1,13 +1,12 @@
 import React from 'react';
 import PropTypes from 'prop-types';
-import { PageLayout } from '../../common/components/web';
 
 const SubscribersOnlyView = ({ loading, number }) => {
   return (
-    <PageLayout>
+    <section>
       <h1>Private</h1>
       <p>Your magic number is {loading ? 'loading...' : number}.</p>
-    </PageLayout>
+    </section>
   );
 };
 
diff --git a/packages/client/src/modules/subscription/components/SubscriptionView.web.jsx b/packages/client/src/modules/subscription/components/SubscriptionView.web.jsx
index 90a5ad61..fad24098 100644
--- a/packages/client/src/modules/subscription/components/SubscriptionView.web.jsx
+++ b/packages/client/src/modules/subscription/components/SubscriptionView.web.jsx
@@ -4,7 +4,6 @@ import Helmet from 'react-helmet';
 import { Elements } from 'react-stripe-elements';
 
 import { LayoutCenter, clientOnly } from '../../common/components';
-import { PageLayout } from '../../common/components/web';
 import SubscriptionCardForm from './SubscriptionCardForm';
 import settings from '../../../../../../settings';
 
@@ -43,7 +42,7 @@ export default class SubscriptionView extends React.Component {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Subscription!</h1>
@@ -51,7 +50,7 @@ export default class SubscriptionView extends React.Component {
             <SubscriptionCardForm onSubmit={this.onSubmit(subscribe)} action="Subscribe" />
           </ElementsClientOnly>
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/subscription/components/UpdateCardView.web.jsx b/packages/client/src/modules/subscription/components/UpdateCardView.web.jsx
index 92661f5b..5adbe6e6 100644
--- a/packages/client/src/modules/subscription/components/UpdateCardView.web.jsx
+++ b/packages/client/src/modules/subscription/components/UpdateCardView.web.jsx
@@ -3,7 +3,6 @@ import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { Elements } from 'react-stripe-elements';
 import { LayoutCenter } from '../../common/components';
-import { PageLayout } from '../../common/components/web';
 
 import SubscriptionCardForm from './SubscriptionCardForm';
 import settings from '../../../../../../settings';
@@ -41,7 +40,7 @@ export default class UpdateCardView extends React.Component {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Update card!</h1>
@@ -49,7 +48,7 @@ export default class UpdateCardView extends React.Component {
             <SubscriptionCardForm onSubmit={this.onSubmit(updateCard)} action="Update Card" />
           </Elements>
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/upload/components/UploadView.web.jsx b/packages/client/src/modules/upload/components/UploadView.web.jsx
index dd4dc018..7338179d 100644
--- a/packages/client/src/modules/upload/components/UploadView.web.jsx
+++ b/packages/client/src/modules/upload/components/UploadView.web.jsx
@@ -3,7 +3,7 @@ import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import Dropzone from 'react-dropzone';
 import filesize from 'filesize';
-import { PageLayout, Row, Col, Table, Button, Alert } from '../../common/components/web';
+import { Row, Col, Table, Button, Alert } from '../../common/components/web';
 import settings from '../../../../../../settings';
 
 export default class UploadView extends React.PureComponent {
@@ -76,7 +76,7 @@ export default class UploadView extends React.PureComponent {
     ];
 
     return (
-      <PageLayout>
+      <section>
         {this.renderMetaData()}
         <div className="text-center">
           <Row>
@@ -91,7 +91,7 @@ export default class UploadView extends React.PureComponent {
             </Col>
           </Row>
         </div>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/user/components/ForgotPasswordView.web.jsx b/packages/client/src/modules/user/components/ForgotPasswordView.web.jsx
index c808f7f7..db2b51b3 100644
--- a/packages/client/src/modules/user/components/ForgotPasswordView.web.jsx
+++ b/packages/client/src/modules/user/components/ForgotPasswordView.web.jsx
@@ -2,7 +2,6 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { LayoutCenter } from '../../common/components';
-import { PageLayout } from '../../common/components/web';
 
 import ForgotPasswordForm from '../components/ForgotPasswordForm';
 import settings from '../../../../../../settings';
@@ -46,13 +45,13 @@ export default class ForgotPasswordView extends React.Component {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Password Reset</h1>
           <ForgotPasswordForm onSubmit={this.onSubmit({ forgotPassword })} sent={this.state.sent} />
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/user/components/LoginView.web.jsx b/packages/client/src/modules/user/components/LoginView.web.jsx
index 99074b0a..612656c9 100644
--- a/packages/client/src/modules/user/components/LoginView.web.jsx
+++ b/packages/client/src/modules/user/components/LoginView.web.jsx
@@ -2,7 +2,7 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { LayoutCenter } from '../../common/components';
-import { PageLayout, Card, CardGroup, CardTitle, CardText } from '../../common/components/web';
+import { Card, CardGroup, CardText, CardTitle } from '../../common/components/web';
 
 import LoginForm from '../components/LoginForm';
 import settings from '../../../../../../settings';
@@ -41,7 +41,7 @@ export default class LoginView extends React.PureComponent {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Sign In</h1>
@@ -56,7 +56,7 @@ export default class LoginView extends React.PureComponent {
             </CardGroup>
           </Card>
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/user/components/ProfileView.web.jsx b/packages/client/src/modules/user/components/ProfileView.web.jsx
index 9564c399..d1a6c7a2 100644
--- a/packages/client/src/modules/user/components/ProfileView.web.jsx
+++ b/packages/client/src/modules/user/components/ProfileView.web.jsx
@@ -2,7 +2,7 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { LayoutCenter } from '../../common/components';
-import { Card, CardGroup, CardTitle, CardText, PageLayout } from '../../common/components/web';
+import { Card, CardGroup, CardText, CardTitle } from '../../common/components/web';
 import SubscriptionProfile from '../../subscription/containers/SubscriptionProfile';
 
 import settings from '../../../../../../settings';
@@ -22,14 +22,14 @@ const renderMetaData = () => (
 const ProfileView = ({ loading, currentUser }) => {
   if (loading && !currentUser) {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <div className="text-center">Loading...</div>
-      </PageLayout>
+      </section>
     );
   } else if (currentUser) {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Profile</h1>
@@ -56,14 +56,14 @@ const ProfileView = ({ loading, currentUser }) => {
             {settings.subscription.enabled && <SubscriptionProfile />}
           </Card>
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   } else {
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <h2>No current user logged in</h2>
-      </PageLayout>
+      </section>
     );
   }
 };
diff --git a/packages/client/src/modules/user/components/RegisterView.web.jsx b/packages/client/src/modules/user/components/RegisterView.web.jsx
index a9a1cbce..6a5d1364 100644
--- a/packages/client/src/modules/user/components/RegisterView.web.jsx
+++ b/packages/client/src/modules/user/components/RegisterView.web.jsx
@@ -2,7 +2,6 @@ import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { LayoutCenter } from '../../common/components';
-import { PageLayout } from '../../common/components/web';
 
 import RegisterForm from '../components/RegisterForm';
 import settings from '../../../../../../settings';
@@ -39,13 +38,13 @@ export default class RegisterView extends React.PureComponent {
 
   render() {
     return (
-      <PageLayout>
+      <section>
         {this.renderMetaData()}
         <LayoutCenter>
           <h1 className="text-center">Sign Up</h1>
           <RegisterForm onSubmit={this.onSubmit} />
         </LayoutCenter>
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/user/components/ResetPasswordView.web.jsx b/packages/client/src/modules/user/components/ResetPasswordView.web.jsx
index 79aa7570..e51ffb83 100644
--- a/packages/client/src/modules/user/components/ResetPasswordView.web.jsx
+++ b/packages/client/src/modules/user/components/ResetPasswordView.web.jsx
@@ -1,7 +1,6 @@
 import React from 'react';
 import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
-import { PageLayout } from '../../common/components/web';
 
 import ResetPasswordForm from '../components/ResetPasswordForm';
 import settings from '../../../../../../settings';
@@ -47,11 +46,11 @@ export default class ResetPasswordView extends React.Component {
     );
 
     return (
-      <PageLayout>
+      <section>
         {renderMetaData()}
         <h1>Reset password!</h1>
         <ResetPasswordForm onSubmit={this.onSubmit(resetPassword)} />
-      </PageLayout>
+      </section>
     );
   }
 }
diff --git a/packages/client/src/modules/user/components/UserEditView.jsx b/packages/client/src/modules/user/components/UserEditView.jsx
index 42281a1d..50873311 100644
--- a/packages/client/src/modules/user/components/UserEditView.jsx
+++ b/packages/client/src/modules/user/components/UserEditView.jsx
@@ -3,7 +3,6 @@ import PropTypes from 'prop-types';
 import Helmet from 'react-helmet';
 import { Link } from 'react-router-dom';
 import { pick } from 'lodash';
-import { PageLayout } from '../../common/components/web';
 
 import UserForm from './UserForm';
 import settings from '../../../../../../settings';
@@ -60,21 +59,21 @@ export default class UserEditView extends React.PureComponent {
 
     if (loading && !user) {
       return (
-        <PageLayout>
+        <section>
           {this.renderMetaData()}
           <div className="text-center">Loading...</div>
-        </PageLayout>
+        </section>
       );
     } else {
       return (
-        <PageLayout>
+        <section>
           {this.renderMetaData()}
           <Link id="back-button" to="/users">
             Back
           </Link>
           <h2>{user ? 'Edit' : 'Create'} User</h2>
           <UserForm onSubmit={this.onSubmit} initialValues={user || {}} />
-        </PageLayout>
+        </section>
       );
     }
   }
diff --git a/packages/client/src/modules/user/components/Users.web.jsx b/packages/client/src/modules/user/components/Users.web.jsx
index f403d1ec..7ab8fba9 100644
--- a/packages/client/src/modules/user/components/Users.web.jsx
+++ b/packages/client/src/modules/user/components/Users.web.jsx
@@ -1,7 +1,7 @@
 import React from 'react';
 import Helmet from 'react-helmet';
 import { Link } from 'react-router-dom';
-import { PageLayout, Button } from '../../common/components/web';
+import { Button } from '../../common/components/web';
 
 import UsersFilter from '../containers/UsersFilter';
 import UsersList from '../containers/UsersList';
@@ -21,7 +21,7 @@ const Users = () => {
   );
 
   return (
-    <PageLayout>
+    <section>
       {renderMetaData()}
       <h2>Users</h2>
       <Link to="/users/0">
@@ -31,7 +31,7 @@ const Users = () => {
       <UsersFilter />
       <hr />
       <UsersList />
-    </PageLayout>
+    </section>
   );
 };
 
diff --git a/packages/client/src/testHelpers/Renderer.js b/packages/client/src/testHelpers/Renderer.js
index ffd56d5f..c8fcde60 100644
--- a/packages/client/src/testHelpers/Renderer.js
+++ b/packages/client/src/testHelpers/Renderer.js
@@ -28,6 +28,7 @@ const ReactEnzymeAdapter = require('enzyme-adapter-react-16');
 const { ApolloProvider } = require('react-apollo');
 const Enzyme = require('enzyme');
 const clientModules = require('../modules').default;
+const { PageLayout } = require('../modules/common/components/web');
 
 const mount = Enzyme.mount;
 
@@ -188,7 +189,9 @@ export default class Renderer {
       this.withApollo(
         clientModules.getWrappedRoot(
           <Router history={this.history}>
-            <Switch>{clientModules.routes}</Switch>
+            <PageLayout>
+              <Switch>{clientModules.routes}</Switch>
+            </PageLayout>
           </Router>
         )
       )
-- 
2.16.2.windows.1

